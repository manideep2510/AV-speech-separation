Training data: 360
Validation data: 240
3D Conv Out: (None, 50, 32, 32, 64)
3D Conv Out Reshape: (None, 32, 32, 64)
Resnet18 Out: (None, 1, 1, 512)
Resnet18 Linear Out: (None, 256)
Input to GRU: (None, 50, 256)
GRU Out: (None, 50, 29)
ResNet LSTM Pretrain weights loaded
outv: (None, 200, 256)
outa: (None, 200, 256)
hidden (None, 256)
attn_out: (None, 200, 512)
attn_states: (None, 200, 200)
fusion: (None, 200, 512)

==================================================================================================
Total params: 29,658,113
Trainable params: 18,093,569
Non-trainable params: 11,564,544
__________________________________________________________________________________________________

Model weights path: test_tdavss_Offset_BothHigh_epochs40_5lr1e-4_exp1

Epoch 1/3
 1/30 [>.............................] - ETA: 3:45 - loss: 45.1030 - snr_acc: -45.1030 2/30 [=>............................] - ETA: 2:19 - loss: 42.6787 - snr_acc: -42.6787 3/30 [==>...........................] - ETA: 1:48 - loss: 37.9536 - snr_acc: -37.9536 4/30 [===>..........................] - ETA: 1:31 - loss: 34.6435 - snr_acc: -34.6435 5/30 [====>.........................] - ETA: 1:21 - loss: 32.1506 - snr_acc: -32.1506 6/30 [=====>........................] - ETA: 1:13 - loss: 30.2361 - snr_acc: -30.2361 7/30 [======>.......................] - ETA: 1:07 - loss: 28.8826 - snr_acc: -28.8826 8/30 [=======>......................] - ETA: 1:02 - loss: 27.5155 - snr_acc: -27.5155 9/30 [========>.....................] - ETA: 57s - loss: 26.3729 - snr_acc: -26.3729 10/30 [=========>....................] - ETA: 54s - loss: 25.2320 - snr_acc: -25.232011/30 [==========>...................] - ETA: 50s - loss: 24.0951 - snr_acc: -24.095212/30 [===========>..................] - ETA: 46s - loss: 23.2122 - snr_acc: -23.212213/30 [============>.................] - ETA: 43s - loss: 22.3288 - snr_acc: -22.328814/30 [=============>................] - ETA: 40s - loss: 21.5173 - snr_acc: -21.517315/30 [==============>...............] - ETA: 37s - loss: 20.8117 - snr_acc: -20.811716/30 [===============>..............] - ETA: 34s - loss: 20.1430 - snr_acc: -20.143017/30 [================>.............] - ETA: 32s - loss: 19.7696 - snr_acc: -19.769618/30 [=================>............] - ETA: 29s - loss: 19.2266 - snr_acc: -19.226619/30 [==================>...........] - ETA: 26s - loss: 18.6898 - snr_acc: -18.689820/30 [===================>..........] - ETA: 24s - loss: 18.1927 - snr_acc: -18.192721/30 [====================>.........] - ETA: 21s - loss: 17.7197 - snr_acc: -17.719722/30 [=====================>........] - ETA: 19s - loss: 17.2763 - snr_acc: -17.276323/30 [======================>.......] - ETA: 16s - loss: 16.8517 - snr_acc: -16.851724/30 [=======================>......] - ETA: 14s - loss: 16.4472 - snr_acc: -16.447325/30 [========================>.....] - ETA: 11s - loss: 16.1337 - snr_acc: -16.133726/30 [=========================>....] - ETA: 9s - loss: 15.7718 - snr_acc: -15.7718 27/30 [==========================>...] - ETA: 7s - loss: 15.4485 - snr_acc: -15.448528/30 [===========================>..] - ETA: 4s - loss: 15.1152 - snr_acc: -15.115229/30 [============================>.] - ETA: 2s - loss: 14.8139 - snr_acc: -14.8139
Goood till now
Preds: 24
Traceback (most recent call last):
  File "main_tasnet_unsync.py", line 162, in <module>
    callbacks=[reducelronplateau, checkpoint_save_weights, metrics_wandb, LoggingCallback(print_fcn=log_to_file), metrics_unsync], verbose=1)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py", line 1297, in fit_generator
    steps_name='steps_per_epoch')
  File "/usr/local/lib/python3.6/dist-packages/wandb/keras/__init__.py", line 104, in new_generator
    return old_generator(*args, **kwargs)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_generator.py", line 332, in model_iteration
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/callbacks.py", line 298, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/data/AV-speech-separation1/metrics.py", line 503, in on_epoch_end
    offset = val_folders_samp_dict[val_folders_samp[i//2]]
TypeError: 'dict_keys' object does not support indexing
