Training data: 360
Validation data: 240
3D Conv Out: (None, 50, 32, 32, 64)
3D Conv Out Reshape: (None, 32, 32, 64)
Resnet18 Out: (None, 1, 1, 512)
Resnet18 Linear Out: (None, 256)
Input to GRU: (None, 50, 256)
GRU Out: (None, 50, 29)
ResNet LSTM Pretrain weights loaded
outv: (None, 200, 256)
outa: (None, 200, 256)
attn_out: (None, 200, 256)
attn_states: (None, 200, 200)
fusion: (None, 200, 512)

==================================================================================================
Total params: 28,607,489
Trainable params: 17,042,945
Non-trainable params: 11,564,544
__________________________________________________________________________________________________

Model weights path: test_tdavss_NoLSTM_BahdanauAttention_25kTrain_randomSeed35_freezeLip_Normalize_ResNetLSTMLip_2secondsClips_epochs40_lr1e-4_0.35decayNoValDec2epochs_exp1

Epoch 1/40
 1/23 [>.............................] - ETA: 2:55 - loss: 47.7952 - snr_acc: -47.7952 2/23 [=>............................] - ETA: 1:33 - loss: 45.4099 - snr_acc: -45.4099 3/23 [==>...........................] - ETA: 1:06 - loss: 42.2891 - snr_acc: -42.2891 4/23 [====>.........................] - ETA: 52s - loss: 39.6699 - snr_acc: -39.6699  5/23 [=====>........................] - ETA: 42s - loss: 37.6836 - snr_acc: -37.6836 6/23 [======>.......................] - ETA: 36s - loss: 37.1398 - snr_acc: -37.1398 7/23 [========>.....................] - ETA: 31s - loss: 36.0398 - snr_acc: -36.0398 8/23 [=========>....................] - ETA: 28s - loss: 34.8896 - snr_acc: -34.8896 9/23 [==========>...................] - ETA: 24s - loss: 34.1031 - snr_acc: -34.103110/23 [============>.................] - ETA: 22s - loss: 33.7600 - snr_acc: -33.760011/23 [=============>................] - ETA: 19s - loss: 33.2145 - snr_acc: -33.214512/23 [==============>...............] - ETA: 17s - loss: 32.6423 - snr_acc: -32.642313/23 [===============>..............] - ETA: 15s - loss: 32.0719 - snr_acc: -32.071914/23 [=================>............] - ETA: 13s - loss: 31.4034 - snr_acc: -31.403415/23 [==================>...........] - ETA: 11s - loss: 30.7405 - snr_acc: -30.740516/23 [===================>..........] - ETA: 10s - loss: 30.4358 - snr_acc: -30.435817/23 [=====================>........] - ETA: 8s - loss: 29.9148 - snr_acc: -29.9148 18/23 [======================>.......] - ETA: 6s - loss: 29.4338 - snr_acc: -29.433819/23 [=======================>......] - ETA: 5s - loss: 28.9975 - snr_acc: -28.997520/23 [=========================>....] - ETA: 4s - loss: 28.5353 - snr_acc: -28.535321/23 [==========================>...] - ETA: 2s - loss: 28.0473 - snr_acc: -28.047322/23 [===========================>..] - ETA: 1s - loss: 27.6564 - snr_acc: -27.6564Traceback (most recent call last):
  File "/data/AV-speech-separation1/main_tasnet.py", line 196, in <module>
    callbacks=[reducelronplateau, save_weights, metrics_wandb, LoggingCallback(print_fcn=log_to_file)], verbose=1)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py", line 1297, in fit_generator
    steps_name='steps_per_epoch')
  File "/usr/local/lib/python3.6/dist-packages/wandb/keras/__init__.py", line 104, in new_generator
    return old_generator(*args, **kwargs)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_generator.py", line 332, in model_iteration
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/callbacks.py", line 298, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/data/AV-speech-separation1/callbacks.py", line 153, in on_epoch_end
    self.model.save_weights('/data/models/' + self.path + 'weights-' + str(int(epoch)) + '-' + str(round(val_loss, 4)) + '.hdf5')
NameError: name 'val_loss' is not defined
