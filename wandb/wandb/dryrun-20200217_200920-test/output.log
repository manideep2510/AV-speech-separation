Training data: 360
Validation data: 240
3D Conv Out: (None, 50, 32, 32, 64)
3D Conv Out Reshape: (None, 32, 32, 64)
Resnet18 Out: (None, 1, 1, 512)
Resnet18 Linear Out: (None, 256)
Input to GRU: (None, 50, 256)
GRU Out: (None, 50, 29)
ResNet LSTM Pretrain weights loaded
outv: (None, 200, 256)
outa: (None, 200, 256)
hidden (None, 256)
attn_out: (None, 200, 512)
attn_states: (None, 200, 200)
fusion: (None, 200, 512)

==================================================================================================
Total params: 29,658,113
Trainable params: 18,093,569
Non-trainable params: 11,564,544
__________________________________________________________________________________________________

Model weights path: test_tdavss_Offset_BothHigh_epochs40_5lr1e-4_exp1

Epoch 1/3
 1/30 [>.............................] - ETA: 3:52 - loss: 53.1308 - snr_acc: -53.1308 2/30 [=>............................] - ETA: 2:23 - loss: 48.1816 - snr_acc: -48.1816 3/30 [==>...........................] - ETA: 1:50 - loss: 45.7720 - snr_acc: -45.7720 4/30 [===>..........................] - ETA: 1:34 - loss: 43.2907 - snr_acc: -43.2907 5/30 [====>.........................] - ETA: 1:22 - loss: 42.4134 - snr_acc: -42.4134 6/30 [=====>........................] - ETA: 1:14 - loss: 41.6636 - snr_acc: -41.6636 7/30 [======>.......................] - ETA: 1:08 - loss: 42.0297 - snr_acc: -42.0297 8/30 [=======>......................] - ETA: 1:03 - loss: 41.2673 - snr_acc: -41.2673 9/30 [========>.....................] - ETA: 58s - loss: 41.6725 - snr_acc: -41.6725 10/30 [=========>....................] - ETA: 54s - loss: 40.9187 - snr_acc: -40.918711/30 [==========>...................] - ETA: 51s - loss: 40.3066 - snr_acc: -40.306612/30 [===========>..................] - ETA: 47s - loss: 39.6240 - snr_acc: -39.624013/30 [============>.................] - ETA: 44s - loss: 38.9763 - snr_acc: -38.976214/30 [=============>................] - ETA: 41s - loss: 38.0670 - snr_acc: -38.067015/30 [==============>...............] - ETA: 38s - loss: 37.4980 - snr_acc: -37.498016/30 [===============>..............] - ETA: 35s - loss: 37.1580 - snr_acc: -37.158017/30 [================>.............] - ETA: 32s - loss: 36.9962 - snr_acc: -36.996218/30 [=================>............] - ETA: 29s - loss: 36.5858 - snr_acc: -36.585819/30 [==================>...........] - ETA: 26s - loss: 36.4169 - snr_acc: -36.416920/30 [===================>..........] - ETA: 24s - loss: 36.0655 - snr_acc: -36.065521/30 [====================>.........] - ETA: 21s - loss: 35.8090 - snr_acc: -35.809022/30 [=====================>........] - ETA: 19s - loss: 35.5178 - snr_acc: -35.517823/30 [======================>.......] - ETA: 16s - loss: 35.2569 - snr_acc: -35.256924/30 [=======================>......] - ETA: 14s - loss: 35.0643 - snr_acc: -35.064325/30 [========================>.....] - ETA: 11s - loss: 34.8893 - snr_acc: -34.889326/30 [=========================>....] - ETA: 9s - loss: 34.7590 - snr_acc: -34.7590 27/30 [==========================>...] - ETA: 7s - loss: 34.5221 - snr_acc: -34.522128/30 [===========================>..] - ETA: 4s - loss: 34.4014 - snr_acc: -34.401429/30 [============================>.] - ETA: 2s - loss: 34.1768 - snr_acc: -34.1768Goood till now
Traceback (most recent call last):
  File "main_tasnet_unsync.py", line 162, in <module>
    callbacks=[reducelronplateau, checkpoint_save_weights, metrics_wandb, LoggingCallback(print_fcn=log_to_file), metrics_unsync], verbose=1)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py", line 1297, in fit_generator
    steps_name='steps_per_epoch')
  File "/usr/local/lib/python3.6/dist-packages/wandb/keras/__init__.py", line 104, in new_generator
    return old_generator(*args, **kwargs)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_generator.py", line 332, in model_iteration
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/callbacks.py", line 298, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/data/AV-speech-separation1/metrics.py", line 475, in on_epoch_end
    12, 32000, 1), np.random.rand(12, 256), np.random.rand(12, 256), np.random.rand(12, 512)])
  File "/data/AV-speech-separation1/models/tdavss_attention2.py", line 185, in predict
    return self.test_function([input_batch, 0])  # the first 0 indicates test
  File "/data/AV-speech-separation1/models/tdavss_attention2.py", line 191, in test_function
    self.initial_cell_state, self.initial_out_state], tf.python.keras.symbolic_learning_phase()],
AttributeError: module 'tensorflow' has no attribute 'python'
