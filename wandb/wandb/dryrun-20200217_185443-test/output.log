Training data: 360
Validation data: 240
3D Conv Out: (None, 50, 32, 32, 64)
3D Conv Out Reshape: (None, 32, 32, 64)
Resnet18 Out: (None, 1, 1, 512)
Resnet18 Linear Out: (None, 256)
Input to GRU: (None, 50, 256)
GRU Out: (None, 50, 29)
ResNet LSTM Pretrain weights loaded
outv: (None, 200, 256)
outa: (None, 200, 256)
hidden (None, 256)
fusion: (None, 200, 512)

==================================================================================================
Total params: 28,082,433
Trainable params: 16,517,889
Non-trainable params: 11,564,544
__________________________________________________________________________________________________

Model weights path: test_tdavss_Offset_BothHigh_epochs40_5lr1e-4_exp1

Epoch 1/3
 1/23 [>.............................] - ETA: 2:42 - loss: 48.9714 - snr_acc: -48.9714 2/23 [=>............................] - ETA: 1:22 - loss: 46.7056 - snr_acc: -46.7056 3/23 [==>...........................] - ETA: 55s - loss: 43.5447 - snr_acc: -43.5447  4/23 [====>.........................] - ETA: 42s - loss: 41.1584 - snr_acc: -41.1584 5/23 [=====>........................] - ETA: 33s - loss: 41.3678 - snr_acc: -41.3678 6/23 [======>.......................] - ETA: 27s - loss: 40.6767 - snr_acc: -40.6767 7/23 [========>.....................] - ETA: 23s - loss: 39.9070 - snr_acc: -39.9070 8/23 [=========>....................] - ETA: 20s - loss: 39.1247 - snr_acc: -39.1247 9/23 [==========>...................] - ETA: 17s - loss: 38.7309 - snr_acc: -38.730910/23 [============>.................] - ETA: 15s - loss: 38.6668 - snr_acc: -38.666811/23 [=============>................] - ETA: 13s - loss: 38.2911 - snr_acc: -38.291112/23 [==============>...............] - ETA: 11s - loss: 38.0642 - snr_acc: -38.064213/23 [===============>..............] - ETA: 10s - loss: 37.9931 - snr_acc: -37.993114/23 [=================>............] - ETA: 8s - loss: 37.5683 - snr_acc: -37.5683 15/23 [==================>...........] - ETA: 7s - loss: 37.2769 - snr_acc: -37.276916/23 [===================>..........] - ETA: 6s - loss: 37.0254 - snr_acc: -37.025417/23 [=====================>........] - ETA: 5s - loss: 36.9382 - snr_acc: -36.938218/23 [======================>.......] - ETA: 4s - loss: 36.9209 - snr_acc: -36.920919/23 [=======================>......] - ETA: 3s - loss: 36.9507 - snr_acc: -36.950720/23 [=========================>....] - ETA: 2s - loss: 36.9908 - snr_acc: -36.990821/23 [==========================>...] - ETA: 1s - loss: 36.7707 - snr_acc: -36.770722/23 [===========================>..] - ETA: 0s - loss: 36.7541 - snr_acc: -36.7541Traceback (most recent call last):
  File "main_tasnet_unsync.py", line 162, in <module>
    callbacks=[reducelronplateau, checkpoint_save_weights, metrics_wandb, LoggingCallback(print_fcn=log_to_file), metrics_unsync], verbose=1)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py", line 1297, in fit_generator
    steps_name='steps_per_epoch')
  File "/usr/local/lib/python3.6/dist-packages/wandb/keras/__init__.py", line 104, in new_generator
    return old_generator(*args, **kwargs)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_generator.py", line 332, in model_iteration
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/callbacks.py", line 298, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/data/AV-speech-separation1/metrics.py", line 468, in on_epoch_end
    val_folders_samp_dict = {'/data/lrs2/train/6265355699075927737_00014_6092759861175370842_00039_2':13, '/data/lrs2/train/6265355699075927737_00014_6084196555380596880_00030_2':12, '/data/lrs2/train/6265355699075927737_00014_5942747390944340934_00018_2':10, '/data/lrs2/train/6265355699075927737_00026_6084196555380596880_00030_2':8, self.val_folders[10]:0, self.val_folders[20]:0, self.val_folders[50]:0, self.val_folders[100]:0, self.val_folders[1600]:0, self.val_folders[1610]:0, self.val_folders[1620]:0, self.val_folders[1630]:0}
IndexError: list index out of range
