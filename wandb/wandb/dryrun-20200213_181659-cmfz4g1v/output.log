Training data: 360
Validation data: 240
3D Conv Out: (None, 50, 32, 32, 64)
3D Conv Out Reshape: (None, 32, 32, 64)
Resnet18 Out: (None, 1, 1, 512)
Resnet18 Linear Out: (None, 256)
Input to GRU: (None, 50, 256)
GRU Out: (None, 50, 29)
ResNet LSTM Pretrain weights loaded
outv: (None, 200, 256)
outa: (None, 200, 256)
hidden (None, 256)
fusion: (None, 200, 512)

==================================================================================================
Total params: 28,082,433
Trainable params: 16,517,889
Non-trainable params: 11,564,544
__________________________________________________________________________________________________

Model weights path: test_tdavss_bothTrainVal_unsync_epochs40_5lr1e-4_exp1

Epoch 1/2
 1/30 [>.............................] - ETA: 2:50 - loss: 52.7859 - snr_acc: -52.7859 2/30 [=>............................] - ETA: 1:28 - loss: 47.1654 - snr_acc: -47.1654 3/30 [==>...........................] - ETA: 1:00 - loss: 46.4428 - snr_acc: -46.4428 4/30 [===>..........................] - ETA: 46s - loss: 45.3944 - snr_acc: -45.3944  5/30 [====>.........................] - ETA: 38s - loss: 44.7334 - snr_acc: -44.7334 6/30 [=====>........................] - ETA: 32s - loss: 43.7508 - snr_acc: -43.7509 7/30 [======>.......................] - ETA: 28s - loss: 43.5590 - snr_acc: -43.5590 8/30 [=======>......................] - ETA: 24s - loss: 42.1404 - snr_acc: -42.1404 9/30 [========>.....................] - ETA: 22s - loss: 41.9516 - snr_acc: -41.951610/30 [=========>....................] - ETA: 19s - loss: 41.3130 - snr_acc: -41.313011/30 [==========>...................] - ETA: 17s - loss: 40.7248 - snr_acc: -40.724812/30 [===========>..................] - ETA: 16s - loss: 40.6082 - snr_acc: -40.608213/30 [============>.................] - ETA: 14s - loss: 39.9508 - snr_acc: -39.950814/30 [=============>................] - ETA: 13s - loss: 39.6239 - snr_acc: -39.623915/30 [==============>...............] - ETA: 12s - loss: 39.8724 - snr_acc: -39.872416/30 [===============>..............] - ETA: 11s - loss: 40.0632 - snr_acc: -40.063217/30 [================>.............] - ETA: 10s - loss: 39.9541 - snr_acc: -39.954118/30 [=================>............] - ETA: 9s - loss: 39.9926 - snr_acc: -39.9926 19/30 [==================>...........] - ETA: 8s - loss: 39.9917 - snr_acc: -39.991720/30 [===================>..........] - ETA: 7s - loss: 39.7876 - snr_acc: -39.787621/30 [====================>.........] - ETA: 6s - loss: 39.9207 - snr_acc: -39.920722/30 [=====================>........] - ETA: 5s - loss: 39.6932 - snr_acc: -39.693223/30 [======================>.......] - ETA: 4s - loss: 39.6156 - snr_acc: -39.615624/30 [=======================>......] - ETA: 4s - loss: 39.5611 - snr_acc: -39.561125/30 [========================>.....] - ETA: 3s - loss: 39.5746 - snr_acc: -39.574626/30 [=========================>....] - ETA: 2s - loss: 39.6687 - snr_acc: -39.668727/30 [==========================>...] - ETA: 1s - loss: 39.6200 - snr_acc: -39.620028/30 [===========================>..] - ETA: 1s - loss: 39.7611 - snr_acc: -39.761129/30 [============================>.] - ETA: 0s - loss: 39.7255 - snr_acc: -39.7255Traceback (most recent call last):
  File "main_tasnet_unsync.py", line 166, in <module>
    callbacks=[reducelronplateau, save_weights, metrics_wandb, LoggingCallback(print_fcn=log_to_file), metrics_unsync], verbose=1)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py", line 1297, in fit_generator
    steps_name='steps_per_epoch')
  File "/usr/local/lib/python3.6/dist-packages/wandb/keras/__init__.py", line 104, in new_generator
    return old_generator(*args, **kwargs)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_generator.py", line 332, in model_iteration
    callbacks.on_epoch_end(epoch, epoch_logs)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/callbacks.py", line 298, in on_epoch_end
    callback.on_epoch_end(epoch, logs)
  File "/data/AV-speech-separation1/metrics.py", line 425, in on_epoch_end
    unsync_dict = json.load(json_file)
NameError: name 'json' is not defined
