Training data: 360
Validation data: 240
3D Conv Out: (None, 50, 32, 32, 64)
3D Conv Out Reshape: (None, 32, 32, 64)
Resnet18 Out: (None, 1, 1, 512)
Resnet18 Linear Out: (None, 256)
Input to GRU: (None, 50, 256)
GRU Out: (None, 50, 29)
ResNet LSTM Pretrain weights loaded
outv: (None, 200, 256)
outa: (None, 200, 256)
hidden (None, 256)
fusion: (None, 200, 512)

==================================================================================================
Total params: 28,082,433
Trainable params: 16,517,889
Non-trainable params: 11,564,544
__________________________________________________________________________________________________

Model weights path: test_tdavss_Offset_BothHigh_epochs40_5lr1e-4_exp1

Epoch 1/3
 1/23 [>.............................] - ETA: 2:42 - loss: 46.7231 - snr_acc: -46.7231 2/23 [=>............................] - ETA: 1:22 - loss: 44.8426 - snr_acc: -44.8426 3/23 [==>...........................] - ETA: 55s - loss: 44.1699 - snr_acc: -44.1699  4/23 [====>.........................] - ETA: 42s - loss: 42.7372 - snr_acc: -42.7372 5/23 [=====>........................] - ETA: 33s - loss: 42.0036 - snr_acc: -42.0036 6/23 [======>.......................] - ETA: 27s - loss: 41.8475 - snr_acc: -41.8475 7/23 [========>.....................] - ETA: 23s - loss: 41.8865 - snr_acc: -41.8865 8/23 [=========>....................] - ETA: 20s - loss: 41.2021 - snr_acc: -41.2021 9/23 [==========>...................] - ETA: 17s - loss: 40.6843 - snr_acc: -40.684310/23 [============>.................] - ETA: 15s - loss: 40.3084 - snr_acc: -40.308411/23 [=============>................] - ETA: 13s - loss: 39.8744 - snr_acc: -39.874412/23 [==============>...............] - ETA: 11s - loss: 39.7570 - snr_acc: -39.757013/23 [===============>..............] - ETA: 10s - loss: 39.3475 - snr_acc: -39.347514/23 [=================>............] - ETA: 8s - loss: 39.4042 - snr_acc: -39.4042 15/23 [==================>...........] - ETA: 7s - loss: 39.5362 - snr_acc: -39.536216/23 [===================>..........] - ETA: 6s - loss: 39.5733 - snr_acc: -39.573317/23 [=====================>........] - ETA: 5s - loss: 39.3245 - snr_acc: -39.324518/23 [======================>.......] - ETA: 4s - loss: 39.0974 - snr_acc: -39.097419/23 [=======================>......] - ETA: 3s - loss: 38.8885 - snr_acc: -38.888620/23 [=========================>....] - ETA: 2s - loss: 38.5471 - snr_acc: -38.547121/23 [==========================>...] - ETA: 1s - loss: 38.2131 - snr_acc: -38.213122/23 [===========================>..] - ETA: 0s - loss: 38.0491 - snr_acc: -38.0491list index out of range
Final model saved
Traceback (most recent call last):
  File "main_tasnet_unsync.py", line 183, in <module>
    plot_loss_and_acc(history, path)
NameError: name 'history' is not defined
